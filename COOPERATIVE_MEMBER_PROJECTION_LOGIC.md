# 組合員数将来推計ロジック - 詳細仕様書

## 概要
農業協同組合員の将来推計を行うためのロジック。2025年を基準として2050年まで5年間隔で推計を実施。

## 基本前提
- **基準年**: 2025年
- **推計期間**: 2030年～2050年（5年間隔）
- **対象**: 全47都道府県
- **年齢階級**: 20歳以上（5歳階級別）
- **データ単位**: 千人単位

## 1. 基準データ（2025年）

### 1.1 都道府県別総組合員数（千人単位）
```javascript
this.prefectureTotalMembers = {
  '01': 2000,     // 北海道
  '02': 161.337,  // 青森県
  '03': 292.156,  // 岩手県
  // ... 全47都道府県
};
```

### 1.2 全国年齢構成比
```javascript
this.nationalAgeDistribution = {
  '20-24': 0.0066,  // 0.66%
  '25-29': 0.0074,  // 0.74%
  '30-34': 0.0395,  // 3.95%
  '35-39': 0.0445,  // 4.45%
  // ... 95-99歳まで
};
```

## 2. 年齢階級別推計方法

### 2.1 20-34歳：シェア率維持方式

**基本ロジック**:
```javascript
// 2025年のシェア率計算
shareRate2025 = 組合員数（千人） ÷ 人口（千人）

// 将来年の組合員数計算
memberCount = その年の人口（千人） × shareRate2025
```

**前提**:
- 若年層は新規加入により人口に対するシェア率を維持
- 各年の実際の人口推計データを使用
- 地域による人口流入・流出を自動的に反映

**実装例**:
```javascript
// 北海道20-24歳の例
// 2025年: 13.2人 ÷ 105千人 = 0.000126のシェア率
// 2030年: 136千人 × 0.000126 = 17.1人
```

### 2.2 35歳以上：コホート進行方式

**基本ロジック**:
```javascript
// 前期の1つ下の年齢層から進行
sourceMembers = 前期の下位年齢層組合員数
populationAdjustment = 1 + 人口変化率
survivalFactor = 生存率（70歳以上のみ）

memberCount = sourceMembers × populationAdjustment × survivalFactor
```

**前提**:
- 5年前の下位年齢層から自然に年齢上昇
- 人口変化による調整を適用
- 70歳以上は死亡による減衰を考慮

## 3. 人口変化率データ

### 3.1 データ構造
```json
{
  "2030": {
    "01": {
      "20-24": { "total": -0.0234 },
      "25-29": { "total": 0.0156 },
      // ... 全年齢階級
    },
    // ... 全47都道府県
  },
  // ... 2050年まで
}
```

### 3.2 算出方法
```javascript
// 5年間隔の変化率
changeRate = (当該年人口 - 5年前人口) / 5年前人口

// 例：2030年 = (2030年人口 - 2025年人口) / 2025年人口
//     2035年 = (2035年人口 - 2030年人口) / 2030年人口
```

### 3.3 地域差の特徴
- **人口減少地域**（東北・北海道等）: 多くの年齢層でマイナス成長
- **人口増加地域**（首都圏・関西圏等）: 特に若年層でプラス成長
- **高齢化進行地域**: 高齢層の増加率が高い

## 4. 生存率（死亡による減衰）

### 4.1 適用対象
70歳以上のみに適用（69歳以下は生存率100%として扱う）

### 4.2 都道府県別生存率（5年間）
```javascript
// 北海道の例
'01': {
  '70-74': 0.933,  // 93.3%
  '75-79': 0.869,  // 86.9%
  '80-84': 0.765,  // 76.5%
  '85-89': 0.603,  // 60.3%
  '90-94': 0.391,  // 39.1%
  '95-99': 0.182   // 18.2%
}
```

### 4.3 地域差
- **長寿地域**（沖縄等）: 相対的に高い生存率
- **医療充実地域**（東京・大阪等）: 全国平均より高い生存率
- **高齢化進行地域**: 全国平均程度の生存率

## 5. 推計実行プロセス

### 5.1 ステップ1: 基準年（2025年）データ準備
1. 都道府県別総組合員数の設定
2. 全国年齢構成比による年齢別配分
3. 人口データとの照合によるシェア率計算

### 5.2 ステップ2: 将来推計（2030年～2050年）
```javascript
while (currentYear < targetYear) {
  const nextYear = currentYear + 5;
  
  for (const ageGroup of this.ageGroups) {
    if (ageGroup in ['20-24', '25-29', '30-34']) {
      // シェア率維持方式
      memberCount = nextYearPopulation × shareRate2025;
    } else {
      // コホート進行方式
      memberCount = previousMemberCount × populationAdjustment × survivalRate;
    }
  }
  
  currentYear = nextYear;
}
```

### 5.3 ステップ3: データ出力
- JSON形式で都道府県別・年度別・年齢階級別データを出力
- 千人単位での統一表記
- 人口ピラミッド表示用フォーマット

## 6. データソース

### 6.1 人口データ
- **出典**: e-Stat API（国勢調査・人口推計）
- **精度**: 国の公式統計データ
- **更新**: 最新推計の公表に合わせて更新

### 6.2 死亡率データ
- **出典**: 厚生労働省人口動態統計
- **調整**: 地域の医療環境・高齢化率による補正
- **算出**: 年間死亡率から5年生存率を計算

### 6.3 組合員基準データ
- **出典**: 生協データ総覧・各都道府県統計
- **基準**: 2025年実績値（または最新推定値）

## 7. 特徴と優位性

### 7.1 現実性
- 人口動態と死亡率を組み合わせた自然な減少トレンド
- 地域差を反映した精密な推計
- 新規加入（若年層）と自然減（高齢層）のバランス

### 7.2 柔軟性
- 基準データの更新が容易
- 推計期間の延長・短縮が可能
- 地域別の特殊事情を反映可能

### 7.3 検証可能性
- 各ステップの計算過程が透明
- 中間年度での実績値との比較検証が可能
- 感度分析による不確実性の評価が可能

## 8. 活用方法

### 8.1 政策立案
- 地域別の組合員減少予測による対策検討
- 年齢構成変化に対応したサービス設計
- 将来の事業規模予測

### 8.2 事業計画
- 中長期的な事業計画の基礎データ
- 地域間格差の将来予測
- 投資・撤退判断の根拠資料

### 8.3 比較分析
- 都道府県間の将来動向比較
- 年齢構成変化の地域差分析
- 政策効果の事前評価

---

**作成日**: 2025年1月
**バージョン**: 1.0
**実装ファイル**: `scripts/generateAllPrefectureCoopProjections.js`